---
phase: 04-dashboard
plan: 02
type: execute
---

<objective>
Add hover autoplay to video cards and create a full-screen video player dialog for viewing completed videos.

Purpose: Let agents preview videos quickly on hover, and watch full videos in an immersive player.
Output: VideoCard with hover autoplay, VideoPlayerDialog component for full viewing experience.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Dependency
@.planning/phases/04-dashboard/04-01-PLAN.md

# Existing codebase
@src/components/dashboard/VideoCard.tsx
@src/components/ui/dialog.tsx
@src/types/video.ts

**Tech stack available:**
- Native HTML5 `<video>` element (no external player library needed)
- Radix Dialog from shadcn/ui
- Framer Motion for animations
- Tailwind CSS

**Established patterns:**
- Videos are 9:16 vertical format (1080x1920)
- branded_url contains the video URL (MP4 from json2video/S3)
- thumbnail_url for poster image

**Video URLs:**
- branded_url: Full video with agent branding
- unbranded_url: MLS-compliant version without branding
- Both are MP4 format from json2video rendering
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add hover autoplay to VideoCard</name>
  <files>src/components/dashboard/VideoCard.tsx</files>
  <action>
Enhance VideoCard with hover autoplay for completed videos:

1. Add video element that shows on hover (hidden by default):
   - Use `<video>` with muted, loop, playsInline attributes
   - src={video.branded_url} when status is 'completed'
   - poster={video.thumbnail_url}

2. Hover behavior:
   - onMouseEnter: video.play(), hide thumbnail, show video
   - onMouseLeave: video.pause(), video.currentTime = 0, show thumbnail
   - Use useRef for video element reference

3. Only enable hover autoplay for completed videos with branded_url

4. Keep thumbnail visible for non-completed videos (pending, processing, failed)

5. Visual feedback: Add subtle loading spinner during video load (onWaiting/onCanPlay)

Do NOT add click handler for full player yet (Task 2 handles that).
  </action>
  <verify>Hover over a completed video card - video starts playing muted, stops on mouse leave</verify>
  <done>VideoCard plays video on hover for completed videos, shows thumbnail for others</done>
</task>

<task type="auto">
  <name>Task 2: Create VideoPlayerDialog component</name>
  <files>src/components/dashboard/VideoPlayerDialog.tsx</files>
  <action>
Create a dialog component for full-screen video viewing:

1. Use Radix Dialog from shadcn/ui as base

2. Dialog content:
   - Dark overlay (bg-black/90)
   - Centered video player maintaining 9:16 aspect ratio
   - Max height 90vh to fit screen
   - Native video controls (controls attribute)
   - autoPlay when dialog opens

3. Props:
   - video: VideoWithListing (includes branded_url, address)
   - open: boolean
   - onOpenChange: (open: boolean) => void

4. Header overlay (top of video):
   - Property address
   - Close button (X icon)

5. Keyboard support:
   - Escape closes dialog (Radix handles this)
   - Space toggles play/pause (need to add)

6. Style for luxury feel:
   - Smooth fade-in animation
   - Rounded corners on video
  </action>
  <verify>Click on a completed video card - dialog opens with full video player, Escape closes</verify>
  <done>VideoPlayerDialog renders full-screen player with controls, address header, close button</done>
</task>

<task type="auto">
  <name>Task 3: Wire up card click to open player</name>
  <files>src/components/dashboard/VideoCard.tsx, src/app/(protected)/dashboard/page.tsx</files>
  <action>
Connect VideoCard clicks to VideoPlayerDialog:

1. In dashboard page:
   - Add state for selected video: `const [selectedVideo, setSelectedVideo] = useState<VideoWithListing | null>(null)`
   - Add VideoPlayerDialog at bottom of page
   - Pass selectedVideo and open state

2. In VideoCard:
   - Add onClick prop: `onSelect?: () => void`
   - Only clickable for completed videos (cursor-pointer class conditional)
   - Call onSelect on click

3. Pass onSelect from dashboard to each VideoCard:
   - `onSelect={() => setSelectedVideo(video)}`

4. Visual affordance:
   - Play icon overlay on completed videos (visible on hover)
   - "Processing..." text on in-progress videos
  </action>
  <verify>Click completed video card → dialog opens with video playing. Click non-completed → nothing happens.</verify>
  <done>Clicking completed VideoCard opens VideoPlayerDialog, non-completed cards are not clickable</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] Hover on completed video card → video autoplays muted
- [ ] Mouse leave → video stops and resets
- [ ] Click completed video → full player dialog opens
- [ ] Video plays with native controls in dialog
- [ ] Escape or click outside closes dialog
- [ ] Non-completed videos show thumbnail, not clickable
</verification>

<success_criteria>
- Hover autoplay works smoothly for completed videos
- VideoPlayerDialog provides full viewing experience
- Click interaction properly wired between card and dialog
- No playback issues or memory leaks (video refs cleaned up)
</success_criteria>

<output>
After completion, create `.planning/phases/04-dashboard/04-02-SUMMARY.md` following summary template.
</output>
