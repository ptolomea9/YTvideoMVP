---
phase: 04-dashboard
plan: 01
type: execute
---

<objective>
Build the video gallery layout with 9:16 aspect ratio cards showing video thumbnails, property address, and status badges.

Purpose: Give agents a cinematic visual overview of all their generated videos.
Output: Responsive video grid with VideoCard components displaying thumbnail, address, and status.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior phase context
@.planning/phases/03-n8n-integration/03-07-SUMMARY.md

# Existing codebase
@src/app/(protected)/dashboard/page.tsx
@src/hooks/useVideoStatusSubscription.ts
@src/components/ui/card.tsx
@supabase/migrations/001_initial_schema.sql

**Tech stack available:**
- Next.js 15 App Router (server components)
- Supabase client for data fetching
- shadcn/ui Card component
- Framer Motion for animations
- Tailwind CSS with oklch luxury dark theme

**Established patterns:**
- Server components fetch data via `createClient()` from `@/lib/supabase/server`
- Realtime updates via VideoStatusProvider (already wrapping layout)
- 9:16 aspect ratio = 1080x1920 = aspect-[9/16] in Tailwind

**Videos table schema:**
- id, listing_id, user_id, status, branded_url, unbranded_url, thumbnail_url, duration_seconds, error_message, created_at
- Status enum: pending, processing, sorting_images, generating_motion, generating_audio, rendering, completed, failed
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create VideoCard component</name>
  <files>src/components/dashboard/VideoCard.tsx</files>
  <action>
Create a client component for displaying a single video card:
- Props: video object (id, thumbnail_url, status, listing address, created_at)
- 9:16 aspect ratio container using `aspect-[9/16]` with rounded corners
- Thumbnail image fills card (object-cover) or placeholder gradient if no thumbnail
- Status badge in top-right corner (color-coded: gold=completed, muted=processing, red=failed)
- Property address at bottom with dark gradient overlay for readability
- Hover state: subtle scale (1.02) and border highlight using Framer Motion
- Use existing Card component from shadcn/ui as base, customize for 9:16 aspect

Do NOT add video playback yet (that's 04-02). This is just the static card layout.
  </action>
  <verify>Component renders without errors: `npm run build` passes</verify>
  <done>VideoCard.tsx exists with proper TypeScript types, renders 9:16 card with thumbnail/placeholder, status badge, and address overlay</done>
</task>

<task type="auto">
  <name>Task 2: Build video gallery grid with data fetching</name>
  <files>src/app/(protected)/dashboard/page.tsx</files>
  <action>
Replace placeholder content with actual video gallery:

1. Fetch user's videos from Supabase with listing data (JOIN for address):
   ```sql
   SELECT videos.*, listings.address
   FROM videos
   JOIN listings ON videos.listing_id = listings.id
   WHERE videos.user_id = ?
   ORDER BY videos.created_at DESC
   ```

2. Create responsive grid layout:
   - Mobile: 2 columns
   - Tablet: 3 columns
   - Desktop: 4 columns
   - Use CSS Grid with gap-4

3. Map videos to VideoCard components

4. Empty state: Keep existing placeholder UI for zero videos, but style it better:
   - Center in grid area
   - Call-to-action button linking to /create

5. Loading state: Not needed for server component (no suspense boundary yet)

Use server component for initial fetch. Realtime updates already handled by VideoStatusProvider.
  </action>
  <verify>Visit /dashboard - shows video grid with cards OR empty state if no videos</verify>
  <done>Dashboard page fetches videos with listing addresses, renders responsive grid of VideoCards, shows empty state with CTA when no videos</done>
</task>

<task type="auto">
  <name>Task 3: Add video type definition</name>
  <files>src/types/video.ts</files>
  <action>
Create shared type definitions for video data used across dashboard:

```typescript
export interface Video {
  id: string;
  listing_id: string;
  user_id: string;
  status: VideoStatus;
  thumbnail_url: string | null;
  branded_url: string | null;
  unbranded_url: string | null;
  duration_seconds: number | null;
  error_message: string | null;
  created_at: string;
}

export type VideoStatus =
  | 'pending'
  | 'processing'
  | 'sorting_images'
  | 'generating_motion'
  | 'generating_audio'
  | 'rendering'
  | 'completed'
  | 'failed';

export interface VideoWithListing extends Video {
  listing: {
    address: string;
    city: string | null;
    state: string | null;
  };
}
```

Export from index file for clean imports.
  </action>
  <verify>`npm run build` passes with no type errors</verify>
  <done>Video types exported from src/types/video.ts, used in VideoCard and dashboard page</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] /dashboard shows responsive grid (test at different viewport widths)
- [ ] VideoCard renders with proper 9:16 aspect ratio
- [ ] Status badge shows correct color for different statuses
- [ ] Empty state shows CTA button to /create
</verification>

<success_criteria>
- VideoCard component renders 9:16 cards with thumbnail, status, and address
- Dashboard page fetches videos and displays in responsive grid
- Type definitions shared and properly typed
- No TypeScript errors or build failures
</success_criteria>

<output>
After completion, create `.planning/phases/04-dashboard/04-01-SUMMARY.md` following summary template.
</output>
